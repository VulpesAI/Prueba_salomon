# --- Entorno general ---
NODE_ENV=development
CORE_API_PORT=8080
FRONTEND_PORT=3000

# --- Base de datos Supabase ---
# Los valores reales provienen de SECRETS.postgres.* cuando se descifra secrets.enc.json.
POSTGRES_HOST=<SECRETS.postgres.host>
POSTGRES_PORT=<SECRETS.postgres.port>
POSTGRES_USER=<SECRETS.postgres.user>
POSTGRES_PASSWORD=<SECRETS.postgres.password>
POSTGRES_DB=<SECRETS.postgres.database>

# --- Credenciales públicas de Supabase ---
# El backend toma el Service Role desde SECRETS.supabase.serviceRoleKey.
SUPABASE_URL=https://<tu-proyecto>.supabase.co
SUPABASE_ANON_KEY=<tu-anon-key-publico>
SUPABASE_SERVICE_ROLE_KEY=<SECRETS.supabase.serviceRoleKey>
SUPABASE_KEY=<SECRETS.supabase.serviceRoleKey>

# --- Seguridad y autenticación ---
# JWT_SECRET se resuelve desde SECRETS.jwt.secret.
JWT_SECRET=<SECRETS.jwt.secret>
JWT_EXPIRES_IN=24h
FRONTEND_URL=http://localhost:3001

# --- Firebase ---
ENABLE_FIREBASE=true
# Los valores privados se inyectan desde SECRETS.firebase.*
FIREBASE_PROJECT_ID=<SECRETS.firebase.projectId>
FIREBASE_CLIENT_EMAIL=<SECRETS.firebase.clientEmail>
# URL de la Realtime Database utilizada por Firebase Admin (opcional).
FIREBASE_DATABASE_URL=<SECRETS.firebase.databaseUrl>
# Reemplaza los saltos de línea del JSON por \n cuando utilices variables individuales.
FIREBASE_PRIVATE_KEY="<SECRETS.firebase.privateKey>"
# Alternativamente, pega aquí el JSON del service account en una sola línea (minificado).
FIREBASE_SERVICE_ACCOUNT_KEY=<SECRETS.firebase.serviceAccountKey>

# --- Integraciones core-api ---
# Manténlos en blanco si no tienes los servicios externos. Usa SECRETS.qdrant y SECRETS.forecasting para valores sensibles.
KAFKA_BROKER=
KAFKA_CLIENT_ID=
QDRANT_URL=<SECRETS.qdrant.url>
QDRANT_COLLECTION=<SECRETS.qdrant.collection>
RECOMMENDATION_ENGINE_URL=
RECOMMENDATION_ENGINE_TIMEOUT_MS=
RECOMMENDATION_INGEST_INTERVAL_MS=
FORECASTING_ENGINE_URL=
FORECASTING_ENGINE_TIMEOUT_MS=
FORECASTING_DEFAULT_MODEL=
FORECASTING_DEFAULT_HORIZON_DAYS=
FORECASTING_DATABASE_URL=<SECRETS.forecasting.databaseUrl>
CORE_API_BASE_URL=

# --- Simulation Engine ---
FEATURE_SIMULATIONS=false
SIMULATION_RATE_LIMIT_REQUESTS=30
SIMULATION_RATE_LIMIT_WINDOW_SECONDS=60
SIMULATION_ALLOWED_ORIGINS=http://localhost:3001

# --- Conversación ---
CONVERSATION_ENGINE_ALLOWED_ORIGINS=http://localhost:3001
CONVERSATION_ENGINE_CORE_TIMEOUT_SECONDS=10
CONVERSATION_ENGINE_SUPABASE_TIMEOUT_SECONDS=10
CONVERSATION_ENGINE_QDRANT_RESULT_LIMIT=5
CONVERSATION_ENGINE_QDRANT_SCORE_THRESHOLD=0.4
OPENAI_API_KEY=
OPENAI_BASE_URL=
CONVERSATION_ENGINE_OPENAI_MODEL=gpt-4o-mini
CONVERSATION_ENGINE_OPENAI_EMBEDDING_MODEL=text-embedding-3-small
CONVERSATION_ENGINE_OPENAI_TIMEOUT_SECONDS=20
CONVERSATION_ENGINE_LLM_TEMPERATURE=0.2
CONVERSATION_ENGINE_LLM_MAX_TOKENS=600
CONVERSATION_ENGINE_LLM_CONTEXT_ITEMS=5
# Personaliza el prompt del sistema solo si necesitas ajustar el tono por ambiente.
#CONVERSATION_ENGINE_LLM_SYSTEM_PROMPT=Eres SalomonAI...

# --- Motores especializados ---
RECOMMENDATION_LOG_LEVEL=INFO
RECOMMENDATION_PIPELINE_MODE=api
RECOMMENDATION_FINANCIAL_MOVEMENTS_API_URL=
RECOMMENDATION_KAFKA_BOOTSTRAP_SERVERS=
RECOMMENDATION_KAFKA_TRANSACTIONS_TOPIC=
RECOMMENDATION_PIPELINE_REFRESH_SECONDS=
RECOMMENDATION_PIPELINE_CLUSTER_COUNT=
RECOMMENDATION_PIPELINE_API_TIMEOUT=
RECOMMENDATION_PIPELINE_KAFKA_BATCH=
RECOMMENDATION_ALLOWED_ORIGINS=
RECOMMENDATION_PORT=
RECOMMENDATION_ENABLE_QDRANT_SYNC=false
RECOMMENDATION_QDRANT_URL=http://qdrant:6333
RECOMMENDATION_QDRANT_API_KEY=
RECOMMENDATION_QDRANT_COLLECTION_USERS=user_finance_profiles
RECOMMENDATION_QDRANT_COLLECTION_ITEMS=reco_items
RECOMMENDATION_QDRANT_TIMEOUT=5.0
RECOMMENDATION_OPENAI_API_KEY=
RECOMMENDATION_EMBEDDING_MODEL=text-embedding-3-small
RECOMMENDATION_EMBEDDING_DIM=1536
RECOMMENDATION_EMBEDDING_VERSION=v1

FINANCIAL_CONNECTOR_ALLOWED_ORIGINS=
FINANCIAL_CONNECTOR_PORT=

KAFKA_BROKER_URL=
KAFKA_TOPIC=
PARSING_ENGINE_GROUP_ID=
PARSING_ENGINE_CONNECTION_RETRIES=
PARSING_ENGINE_RETRY_DELAY_SECONDS=

VOICE_STT_PROVIDER=mock
VOICE_TTS_PROVIDER=mock
VOICE_TTS_DEFAULT_VOICE=alloy
VOICE_TTS_DEFAULT_FORMAT=mp3
VOICE_TTS_DEFAULT_LANG=es-CL
VOICE_TTS_SPEED=1.0
VOICE_TTS_MAX_CHARS=1000
VOICE_OPENAI_API_KEY=
VOICE_OPENAI_STT_MODEL=gpt-4o-mini-transcribe
VOICE_OPENAI_TTS_MODEL=gpt-4o-mini-tts
VOICE_OPENAI_TTS_VOICE=alloy
VOICE_OPENAI_TTS_FORMAT=mp3
VOICE_GATEWAY_ALLOWED_ORIGINS=http://localhost:3001
VOICE_GATEWAY_LOG_LEVEL=INFO

# --- Frontend público ---
NEXT_PUBLIC_API_URL=http://localhost:3000
NEXT_PUBLIC_CONVERSATION_ENGINE_URL=http://localhost:8002
NEXT_PUBLIC_VOICE_GATEWAY_URL=http://localhost:8100
# Rellena estos valores con tus credenciales públicas de Firebase (process.env.NEXT_PUBLIC_* en despliegues).
NEXT_PUBLIC_FIREBASE_API_KEY=<tu-firebase-api-key-publica>
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=<tu-firebase-auth-domain>
NEXT_PUBLIC_FIREBASE_PROJECT_ID=<tu-firebase-project-id>
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=<tu-firebase-storage-bucket>
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=<tu-firebase-messaging-sender-id>
NEXT_PUBLIC_FIREBASE_APP_ID=<tu-firebase-app-id>
NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID=
NEXT_PUBLIC_FIREBASE_SDK_VERSION=10.13.2

# --- Infraestructura Kafka ---
ZOOKEEPER_CLIENT_PORT=2181
ZOOKEEPER_TICK_TIME=2000
KAFKA_BROKER_ID=1
KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
KAFKA_LISTENER_SECURITY_PROTOCOL_MAP=PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT
KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://kafka:9092,PLAINTEXT_HOST://localhost:29092
KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1
KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS=0
KAFKA_TRANSACTION_STATE_LOG_MIN_ISR=1
KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR=1

# --- Otros ---
